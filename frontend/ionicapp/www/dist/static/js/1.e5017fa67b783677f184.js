webpackJsonp([1],{1052:function(e,t,n){var a=n(686);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(17)("0abbb793",a,!0)},1398:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",{attrs:{justify:"space-between"}},[n("Col",{staticClass:"department_title",attrs:{span:"24"}},[n("Icon",{staticStyle:{"margin-left":"20px"},attrs:{type:"card"}}),e._v("\n\t后台 > 部门设置\n\n\t")],1),e._v(" "),n("Col",{attrs:{span:"24"}},[n("Button",{staticClass:"add_button",attrs:{type:"primary"},on:{click:function(t){e.showcreate()}}},[e._v("新建")]),e._v(" "),n("Modal",{attrs:{title:"新建部门","class-name":"addDpartment"},on:{"on-ok":e.addDepartment,"on-cancel":e.cancel},model:{value:e.showcreatedepartment,callback:function(t){e.showcreatedepartment=t},expression:"showcreatedepartment"}},[n("Form",{attrs:{model:e.formItem,"label-width":80}},[n("Form-item",{attrs:{label:"部门名称"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.departmentName,callback:function(t){e.formItem.departmentName=t},expression:"formItem.departmentName"}})],1),e._v(" "),n("Form-item",{attrs:{label:"部门代码"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.departmentCode,callback:function(t){e.formItem.departmentCode=t},expression:"formItem.departmentCode"}})],1),e._v(" "),n("Form-item",{attrs:{label:"上级部门"}},[n("Select",{attrs:{placeholder:"请选择"},model:{value:e.formItem.departmentSuperior,callback:function(t){e.formItem.departmentSuperior=t},expression:"formItem.departmentSuperior"}},e._l(e.departmentSuperiorList,function(t,a){return n("Option",{key:t,attrs:{value:a}},[e._v(e._s(t.departmentName))])}))],1),e._v(" "),n("Form-item",{attrs:{label:"部门主管"}},[n("Input",{attrs:{placeholder:"请选择",icon:"edit"},on:{"on-click":e.showPersonSelect},model:{value:e.formItem.departmentDirector,callback:function(t){e.formItem.departmentDirector=t},expression:"formItem.departmentDirector"}}),e._v(" "),n("personselectnew",{attrs:{switch:e.show},on:{childMsg:e.getChild,sendSelectedPerson:e.getSelectedPerson}})],1),e._v(" "),n("Form-item",{attrs:{label:"描述"}},[n("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入..."},model:{value:e.formItem.departmentDesc,callback:function(t){e.formItem.departmentDesc=t},expression:"formItem.departmentDesc"}})],1)],1)],1)],1),e._v(" "),n("Col",{staticClass:"department_tree",attrs:{span:"6"}},[n("Tree",{ref:"Tree",staticClass:"department_tree_content",attrs:{data:e.baseData},on:{"on-select-change":e.getTreeData}})],1),e._v(" "),n("Col",{staticClass:"department_tree",attrs:{span:"16",offset:"1"}},[n("Tabs",{attrs:{type:"card"}},[n("Tab-pane",{attrs:{label:"部门信息"}},[n("Row",[n("Col",{staticClass:"department_EditInfo",attrs:{span:"24"}},[n("Button",{attrs:{type:"info"},on:{click:e.editdepartmentBtn}},[e._v("编辑部门")]),e._v(" "),n("Button",{staticStyle:{"margin-left":"20px","margin-right":"20px"},attrs:{type:"info"},on:{click:e.removeDepartment}},[e._v("删除部门")]),e._v(" "),n("Modal",{attrs:{title:"编辑部门"},on:{"on-ok":e.updateDepartment,"on-cancel":e.cancel},model:{value:e.editdepartment,callback:function(t){e.editdepartment=t},expression:"editdepartment"}},[n("Form",{attrs:{model:e.departmentInfo,"label-width":80}},[n("Form-item",{attrs:{label:"部门名称"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.departmentInfo.title,callback:function(t){e.departmentInfo.title=t},expression:"departmentInfo.title"}})],1),e._v(" "),n("Form-item",{attrs:{label:"部门代码"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.departmentInfo.departmentCode,callback:function(t){e.departmentInfo.departmentCode=t},expression:"departmentInfo.departmentCode"}})],1),e._v(" "),n("Form-item",{attrs:{label:"上级部门"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.departmentInfo.parentName,callback:function(t){e.departmentInfo.parentName=t},expression:"departmentInfo.parentName"}})],1),e._v(" "),n("Form-item",{attrs:{label:"部门主管"}},[n("Input",{attrs:{placeholder:"departmentInfo.ownerName",icon:"edit"},on:{"on-click":e.showPersonSelectEdit},model:{value:e.departmentInfo.ownerName,callback:function(t){e.departmentInfo.ownerName=t},expression:"departmentInfo.ownerName"}})],1),e._v(" "),n("Form-item",{attrs:{label:"描述"}},[n("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入..."},model:{value:e.departmentInfo.departmentDesc,callback:function(t){e.departmentInfo.departmentDesc=t},expression:"departmentInfo.departmentDesc"}})],1)],1)],1)],1),e._v(" "),n("Col",{staticClass:"department_department_name",attrs:{span:"6"}},[e._v("部门名称")]),e._v(" "),n("Col",{staticClass:"department_department_content",attrs:{span:"18"}},[e._v(e._s(e.departmentInfo.title))]),e._v(" "),n("Col",{staticClass:"department_department_name",attrs:{span:"6"}},[e._v("部门代码")]),e._v(" "),n("Col",{staticClass:"department_department_content",attrs:{span:"18"}},[e._v(e._s(e.departmentInfo.departmentCode))]),e._v(" "),n("Col",{staticClass:"department_department_name",attrs:{span:"6"}},[e._v("上级部门")]),e._v(" "),n("Col",{staticClass:"department_department_content",attrs:{span:"18"}},[e._v(e._s(e.departmentInfo.parentName))]),e._v(" "),n("Col",{staticClass:"department_department_name",attrs:{span:"6"}},[e._v("部门主管")]),e._v(" "),n("Col",{staticClass:"department_department_content",attrs:{span:"18"}},[e._v(e._s(e.departmentInfo.ownerName))]),e._v(" "),n("Col",{staticClass:"department_department_name",attrs:{span:"6"}},[e._v("描述")]),e._v(" "),n("Col",{staticClass:"department_department_content",attrs:{span:"18"}},[e._v(e._s(e.departmentInfo.departmentDesc))])],1)],1),e._v(" "),n("Tab-pane",{attrs:{label:"部门成员"}},[n("Table",{staticStyle:{width:"621px","margin-left":"5px","margin-right":"3px"},attrs:{columns:e.columns1,data:e.data1}})],1)],1)],1)],1)},staticRenderFns:[]}},1631:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{"class-name":"addperson",title:"请选择"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showpersonselect,callback:function(t){e.showpersonselect=t},expression:"showpersonselect"}},[n("Row",[n("Col",{staticStyle:{border:"1px solid #E6E6E6"},attrs:{span:"12"}},[n("Tabs",{attrs:{value:"name1"}},[n("Tab-pane",{attrs:{label:"部门",name:"name1"}},[n("Tree",{ref:"Tree",attrs:{data:e.baseData},on:{"on-select-change":e.getTreeData}}),e._v(" "),n("ul",{staticStyle:{"min-height":"160px","border-top":"1px solid #E6E6E6"}},e._l(e.personListShow,function(t,a){return n("li",{on:{click:function(t){e.addPerson(a)}},model:{value:e.personListShow.id,callback:function(t){e.personListShow.id=t},expression:"personListShow.id"}},[e._v("\n\t\t\t\t\t\t"+e._s(t.personName)+"\n\t\t\t\t\t")])}))],1),e._v(" "),n("Tab-pane",{attrs:{label:"岗位",name:"name2"}},[e._l(e.showPositionList,function(t,a){return n("ul",{staticStyle:{width:"240px",height:"80px"},on:{click:function(t){e.positionAddPerson(a)}}},[n("li",{staticStyle:{float:"left",width:"120px"}},[e._v(e._s(t.jobpositionName))]),e._v(" "),n("li",{staticStyle:{float:"left",width:"120px","text-align":"center"}},[e._v(e._s(t.jobpositionCode))])])}),e._v(" "),n("ul",{staticStyle:{"min-height":"160px","border-top":"1px solid #E6E6E6"}},e._l(e.personListShowPosition,function(t,a){return n("li",{on:{click:function(t){e.addPersonPosition(a)}},model:{value:e.personListShowPosition.id,callback:function(t){e.personListShowPosition.id=t},expression:"personListShowPosition.id"}},[e._v("\n\t\t\t\t\t\t"+e._s(t.personName)+"\n\t\t\t\t\t")])}))],2),e._v(" "),n("Tab-pane",{attrs:{label:"单位",name:"name3"}},[n("ul",{staticStyle:{"min-height":"240px","border-top":"1px solid #E6E6E6"}},e._l(e.personList,function(t,a){return n("li",{on:{click:function(t){e.addPersonCompany(a)}},model:{value:t.id,callback:function(e){t.id=e},expression:"item.id"}},[e._v("\n\t\t\t\t\t\t"+e._s(t.personName)+"\n\t\t\t\t\t")])}))])],1)],1),e._v(" "),n("Col",{staticStyle:{border:"1px solid #E6E6E6","min-height":"300px"},attrs:{span:"11",offset:"1"}},[n("ul",e._l(e.selectedPerson,function(t,a){return n("li",[e._v("\n\t\t\t\t"+e._s(t.personName)+"\n\t\t\t\t"),n("i",{staticClass:"ivu-icon ivu-icon-close",staticStyle:{"margin-left":"150px"},on:{click:function(t){e.removePerson(a)}}})])}))])],1)],1)},staticRenderFns:[]}},165:function(e,t,n){n(1052);var a=n(1)(n(246),n(1631),null,null);e.exports=a.exports},19:function(e,t,n){n(968);var a=n(1)(n(587),n(1398),null,null);e.exports=a.exports},246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0;t.default={props:["switch"],computed:{showpersonselect:function(){return JSON.parse(this.switch)}},data:function(){return{baseData:[{expand:!0,title:"",children:[{title:"",expand:!0},{title:"",expand:!0}]}],showPositionList:[],personList:[],personListShow:[],personListShowPosition:[],selectedPerson:[]}},methods:{ok:function(){a=this.switch,this.$Message.info("点击了确定"),console.log(this.selectedPerson),this.$emit("sendSelectedPerson",this.selectedPerson),a=!1,this.$emit("childMsg",a)},cancel:function(){a=this.switch,this.$Message.info("点击了取消"),a=!1,this.$emit("childMsg",a)},getTreeData:function(){for(var e=0;e<this.personList.length;e++)this.personList[e].departmentId==this.$refs.Tree.getSelectedNodes()[0].id&&this.personListShow.push(this.personList[e])},addPerson:function(e){this.selectedPerson.push(this.personListShow[e])},addPersonPosition:function(e){this.selectedPerson.push(this.personListShowPosition[e])},addPersonCompany:function(e){this.selectedPerson.push(this.personList[e])},positionAddPerson:function(e){for(var t=0;t<this.personList.length;t++)this.personList[t].positionId==this.showPositionList[e].id&&this.personListShowPosition.push(this.personList[t])},removePerson:function(e){this.selectedPerson.splice(e,1)},handlequery:function(){var e=this;this.$http.get(this.globalconfig.listdepartmentapi,{params:{}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");var n=t.data.department,a=function(e){for(var t={},n=[],a=0;0!=e.length;){if(""==e[a].parentId||null==e[a].parentId)n.push({id:e[a].id,title:e[a].departmentName,departmentCode:e[a].departmentCode,departmentDesc:e[a].departmentDesc,parentId:e[a].parentId,ownerId:e[a].ownerId,children:[]}),t[e[a].id]=[n.length-1],e.splice(a,1),a--;else{var r=t[e[a].parentId];if(void 0!=r){for(var s=n[r[0]],o=1;o<r.length;o++)s=s.children[r[o]];s.children.push({id:e[a].id,title:e[a].departmentName,departmentCode:e[a].departmentCode,departmentDesc:e[a].departmentDesc,parentId:e[a].parentId,ownerId:e[a].ownerId,children:[]}),t[e[a].id]=r.concat([s.children.length-1]),e.splice(a,1),a--}}a++,a>e.length-1&&(a=0)}return n}(n);e.baseData=a}},function(t){e.$Message.success("成功")})},showjobposition:function(){var e=this;this.$http.get(this.globalconfig.listjobpositionapi,{params:{}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");for(var n=t.data.jobposition,a=0;a<n.length;a++)e.showPositionList.push(n[a])}},function(t){e.$Message.success("成功")})},showperson:function(){var e=this;this.$http.get(this.globalconfig.listpersonapi,{params:{userStatus:1}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");for(var n=0;n<t.data.person.length;n++)e.personList.push(t.data.person[n])}},function(t){e.$Message.success("成功")})}},mounted:function(){this.handlequery(),this.showjobposition(),this.showperson()}}},587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(165),r=n.n(a),s=[];t.default={components:{personselectnew:r.a,personselectedit:r.a},data:function(){return{showcreatedepartment:!1,show:!1,editdepartment:!1,baseData:[{expand:!0,title:"",checked:!0,children:[{title:"",expand:!0},{title:"",expand:!0}]}],formItem:{departmentName:"",departmentCode:"",departmentSuperior:"",departmentDirectorId:"",departmentDirector:"",departmentDesc:""},departmentSuperiorList:[{departmentName:"无",id:"0"}],departmentInfo:{},columns1:[{title:"姓名",key:"personName"},{title:"登录名",key:"loginName"},{title:"人员编号",key:"email"},{title:"主岗",key:"jobpositionName"},{title:"所属部门",key:"departmentName"},{title:"人员状态",key:"personStatus"}],data1:[],personData:[],position_data1:[]}},methods:{addDepartment:function(){var e=this;this.show=!1,this.$http.get(this.globalconfig.adddepartmentapi,{params:{departmentName:this.formItem.departmentName,departmentCode:this.formItem.departmentCode,parentId:this.departmentSuperiorList[this.formItem.departmentSuperior].id,ownerId:this.formItem.departmentDirectorId,departmentDesc:this.formItem.departmentDesc}},{emulateJSON:!0}).then(function(t){t.body.error?e.$Message.error(t.body.error):(e.$Message.success("创建成功"),document.location.reload())},function(t){e.$Message.success("成功")})},ok:function(){this.$Message.info("点击了确定")},cancel:function(){this.$Message.info("点击了取消"),this.show=!1},showcreate:function(){this.showcreatedepartment=!0},showPersonSelect:function(){this.show=!0},showPersonSelectEdit:function(){this.show=!0},getChild:function(e){console.log(e),this.show=e},getSelectedPerson:function(e){this.showcreatedepartment?(this.formItem.departmentDirectorId=e[0].id,this.formItem.departmentDirector=e[0].personName):(this.departmentInfo.ownerId=e[0].id,this.departmentInfo.ownerName=e[0].personName)},getTreeData:function(){this.departmentInfo=this.$refs.Tree.getSelectedNodes()[0];for(var e=0;e<this.departmentSuperiorList.length;e++)this.departmentInfo.parentId==this.departmentSuperiorList[e].id&&(this.departmentInfo.parentName=this.departmentSuperiorList[e].departmentName);for(var e=0;e<this.data1.length;e++)this.departmentInfo.ownerId==this.data1[e].id&&(this.departmentInfo.ownerName=this.data1[e].personName)},handlequery:function(){var e=this;this.$http.get(this.globalconfig.listdepartmentapi,{params:{}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");for(var n=t.data.department,a=n.length,r=0;r<a;r++)e.departmentSuperiorList.push(n[r]),s.push(n[r]);e.$http.get(e.globalconfig.listpersonapi,{params:{userStatus:1}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");for(var n=t.data.person,a=[],r=0;r<n.length;r++)a.push(n[r]);e.$http.get(e.globalconfig.listjobpositionapi,{params:{}},{emulateJSON:!0}).then(function(t){if(t.body.error)e.$Message.error(t.body.error);else{e.$Message.success("成功");for(var n=t.data.jobposition,r=[],o=0;o<n.length;o++)r.push(t.data.jobposition[o]);for(var i=0;i<a.length;i++)for(var d=0;d<s.length;d++)a[i].departmentId==s[d].id&&(a[i].departmentName=s[d].departmentName);for(var p=0;p<a.length;p++)for(var l=0;l<r.length;l++)a[p].positionId==r[l].id&&(a[p].jobpositionName=r[l].jobpositionName);e.data1=a;var m=function(e){for(var t={},n=[],a=0;0!=e.length;){if(""==e[a].parentId||null==e[a].parentId||0==e[a].parentId)n.push({id:e[a].id,title:e[a].departmentName,departmentCode:e[a].departmentCode,departmentDesc:e[a].departmentDesc,parentId:e[a].parentId,ownerId:e[a].ownerId,parentName:e[a].parentName,ownerName:e[a].ownerName,checked:!0,children:[]}),t[e[a].id]=[n.length-1],e.splice(a,1),a--;else{var r=t[e[a].parentId];if(void 0!=r){for(var s=n[r[0]],o=1;o<r.length;o++)s=s.children[r[o]];s.children.push({id:e[a].id,title:e[a].departmentName,departmentCode:e[a].departmentCode,departmentDesc:e[a].departmentDesc,parentId:e[a].parentId,ownerId:e[a].ownerId,ownerName:e[a].ownerName,parentName:e[a].parentName,children:[]}),t[e[a].id]=r.concat([s.children.length-1]),e.splice(a,1),a--}}a++,a>e.length-1&&(a=0)}return n}(s);e.baseData=m}},function(t){e.$Message.success("成功")})}},function(t){e.$Message.success("成功")})}},function(t){e.$Message.success("成功")})},editdepartmentBtn:function(){this.editdepartment=!0,console.log(this.departmentInfo)},removeDepartment:function(){var e=this,t=this.departmentInfo.id;this.$http.get(this.globalconfig.deletedepartmentapi,{params:{departmentId:t}},{emulateJSON:!0}).then(function(t){t.body.error?e.$Message.error(t.body.error):1==t.data.isDestoryed?(e.$Message.success("删除成功"),document.location.reload()):0==t.data.isDestoryed&&e.$Message.success("有人了，别删")},function(t){e.$Message.success("成功")})},updateDepartment:function(){var e=this;this.$http.get(this.globalconfig.updatedepartmentapi,{params:{departmentName:this.departmentInfo.title,id:this.departmentInfo.id,departmentCode:this.departmentInfo.departmentCode,departmentDesc:this.departmentInfo.departmentDesc,parentId:this.departmentInfo.parentId,ownerId:this.departmentInfo.ownerId}},{emulateJSON:!0}).then(function(t){t.body.error?e.$Message.error(t.body.error):e.$Message.success("成功")},function(t){e.$Message.success("成功")})},integrationData:function(){for(var e=0;e<this.data1.length;e++)for(var t=0;t<this.departmentSuperiorList.length;t++)this.data1[e].departmentId==this.departmentSuperiorList[t].id&&(this.data1[e].departmentName=this.departmentSuperiorList[t].departmentName);for(var e=0;e<this.data1.length;e++)for(var t=0;t<this.position_data1.length;t++)this.data1[e].positionId==this.position_data1[t].id&&(this.data1[e].jobpositionName=this.position_data1[t].jobpositionName);this.data1=this.personData,console.log(this.personData)}},created:function(){this.handlequery()},updated:function(){}}},602:function(e,t,n){t=e.exports=n(16)(),t.push([e.i,".department_title{background:#e6e9ed;height:30px;line-height:30px}.add_button{width:8%;margin-top:10px;margin-bottom:10px}.department_tree{background:#fff;min-height:600px}.department_tree_content{padding:20px 0 0 20px}.department_department_name{text-align:center}.department_department_content,.department_department_name{height:50px;line-height:50px}.department_EditInfo{text-align:right}.department_Dialog{margin-top:10px}","",{version:3,sources:["E:/bpmwww/frontend/framework/src/pages/framework/department.vue"],names:[],mappings:"AACA,kBACC,mBAAoB,AACpB,YAAa,AACb,gBAAkB,CAClB,AACD,YACC,SAAU,AACV,gBAAiB,AACjB,kBAAoB,CACpB,AACD,iBACC,gBAAkB,AAClB,gBAAkB,CAClB,AACD,yBAEC,qBAAuB,CACvB,AACD,4BACC,iBAAmB,CAGnB,AACD,2DAHC,YAAa,AACb,gBAAkB,CAKlB,AACD,qBACC,gBAAkB,CAClB,AACD,mBACC,eAAiB,CACjB",file:"department.vue",sourcesContent:["\n.department_title {\n\tbackground: #e6e9ed;\n\theight: 30px;\n\tline-height: 30px;\n}\n.add_button {\n\twidth: 8%;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n}\n.department_tree {\n\tbackground: white;\n\tmin-height: 600px;\n}\n.department_tree_content {\n\t/*text-align: center;*/\n\tpadding: 20px 0 0 20px;\n}\n.department_department_name {\n\ttext-align: center;\n\theight: 50px;\n\tline-height: 50px;\n}\n.department_department_content {\n\theight: 50px;\n\tline-height: 50px;\n}\n.department_EditInfo {\n\ttext-align: right;\n}\n.department_Dialog {\n\tmargin-top: 10px;\n}\n"],sourceRoot:""}])},686:function(e,t,n){t=e.exports=n(16)(),t.push([e.i,".addperson{z-index:2000}","",{version:3,sources:["E:/bpmwww/frontend/framework/src/pages/components/personselect.vue"],names:[],mappings:"AACA,WACC,YAAc,CACd",file:"personselect.vue",sourcesContent:["\n.addperson {\n\tz-index: 2000;\n}\n"],sourceRoot:""}])},968:function(e,t,n){var a=n(602);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(17)("a3cbfd34",a,!0)}});